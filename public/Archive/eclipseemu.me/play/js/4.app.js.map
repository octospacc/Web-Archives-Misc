{"version":3,"sources":["webpack:///./src/pages/settings/controls/controller.f7.html"],"names":["data","controller","this","$route","context","axes","buttons","gamepads","navigator","getGamepads","filter","Boolean","i","len","length","pad","id","name","controls","on","pageInit","elements","document","querySelectorAll","el","addEventListener","onGamepadInputFocus","onGamepadInputBlur","methods","setKey","JSON","parse","localStorage","getItem","controllerControls","a","b","x","y","up","down","left","right","start","select","l","r","Object","keys","map","key","controllerObject","index","findIndex","obj","push","setItem","stringify","formatGamepadValue","value","axis","dir","evt","focusedEl","target","listenForControllerInput","window","cancelAnimationFrame","rafHandle","find","ctr","pressedIdx","btn","pressed","axisIdx","requestAnimationFrame","render","replace","trim","styleScoped"],"mappings":"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","file":"js/4.app.js","sourcesContent":["const DEAD_ZONE = 0.5;\nexport default {\n  data() {\n    let controller = this.$route.context;\n    let axes = [];\n    let buttons = [];\n    let gamepads = [...navigator.getGamepads()].filter(Boolean);\n    for (let i = 0, len = gamepads.length; i < len; i++) {\n      let pad = gamepads[i];\n      if (pad.id === controller.name) {\n        buttons = pad.buttons;\n        axes = pad.axes;\n      }\n    }\n    return {\n      name: controller.name,\n      controls: controller.controls,\n      buttons: buttons,\n      axes: axes\n    };\n  },\n  on: {\n    pageInit: function () {\n      let elements = document.querySelectorAll('input.gamepad-input');\n      for (let i = 0, len = elements.length; i < len; i++) {\n        let el = elements[i];\n        el.addEventListener('focus', this.onGamepadInputFocus);\n        el.addEventListener('blur', this.onGamepadInputBlur);\n      }\n    }\n  },\n  methods: {\n    setKey() {\n      let controls = JSON.parse(localStorage.getItem('controls'));\n      let controllerControls = {\n        a: 0,\n        b: 0,\n        x: 0,\n        y: 0,\n        up: 0,\n        down: 0,\n        left: 0,\n        right: 0,\n        start: 0,\n        select: 0,\n        l: 0,\n        r: 0\n      };\n      Object.keys(this.controls).map(key => {\n        controllerControls[key] = this.controls[key];\n      });\n      const controllerObject = {\n        name: this.name,\n        controls: controllerControls\n      };\n      const index = controls.findIndex(obj => obj.name === this.name);\n      if (index > -1) {\n        controls[index] = controllerObject;\n      } else {\n        controls.push(controllerObject);\n      }\n      localStorage.setItem('controls', JSON.stringify(controls));\n    },\n    formatGamepadValue: value => typeof value === 'number' ? `Button ${ value }` : `Axis ${ value.axis }${ value.dir === 1 ? '+' : '-' }`,\n    onGamepadInputFocus: function (evt) {\n      this.focusedEl = evt.target;\n      this.listenForControllerInput();\n      this.setKey();\n    },\n    onGamepadInputBlur: function () {\n      this.focusedEl = undefined;\n      window.cancelAnimationFrame(this.rafHandle);\n      this.setKey();\n    },\n    listenForControllerInput: function () {\n      const controller = [...navigator.getGamepads()].find(ctr => ctr.id === this.name);\n      if (!controller || !this.focusedEl)\n        return window.cancelAnimationFrame(this.rafHandle);\n      let value;\n      let pressedIdx = controller.buttons.findIndex(btn => btn.pressed);\n      if (pressedIdx > -1) {\n        value = pressedIdx;\n      }\n      let axisIdx = controller.axes.findIndex(axis => axis > DEAD_ZONE || axis < -DEAD_ZONE);\n      if (axisIdx > -1) {\n        value = {\n          axis: axisIdx,\n          dir: controller.axes[axisIdx] > 0 ? 1 : -1\n        };\n      }\n      if (value !== undefined) {\n        this.focusedEl.value = this.formatGamepadValue(value);\n        this.controls[this.focusedEl.name] = value;\n      }\n      this.rafHandle = window.requestAnimationFrame(this.listenForControllerInput);\n    }\n  },\n  id: 'ee5e624a99',\n  render() {\n    return `\n\t<div class=\"page\">\n\t\t<div class=\"navbar\">\n\t\t\t<div class=\"navbar-inner sliding\">\n\t\t\t\t<div class=\"left\">\n\t\t\t\t\t<a href=\"#\" class=\"link back\"><i class=\"icon icon-back\"></i> <span class=\"ios-only\">Back</span></a>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"title\">\n\t\t\t\t\t${ this.name.replace(/\\((.*)\\)/, '').trim('') }\n\t\t\t\t</div>\n\t\t\t\t<div class=\"title-large\">\n\t\t\t\t\t<div class=\"title-large-text\">\n\t\t\t\t\t\t${ this.name.replace(/\\((.*)\\)/, '').trim('') }\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t\t<div class=\"page-content\">\n\t\t\t<form id=\"controls_form\" name=\"controls_form\">\n\t\t\t\t<div class=\"block-title block-title-medium\">D-Pad</div>\n\t\t\t\t<div class=\"list no-hairlines-md\">\n\t\t\t\t\t<ul>\n\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\t<div class=\"item-content item-input\">\n\t\t\t\t\t\t\t\t<div class=\"item-inner\">\n\t\t\t\t\t\t\t\t\t<div class=\"item-title item-label\">\n\t\t\t\t\t\t\t\t\t\tUp\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<div class=\"item-input-wrap\">\n\t\t\t\t\t\t\t\t\t\t<input class=\"gamepad-input\" maxlength=\"0\" type=\"text\" name=\"up\" id=\"up_input\" value=\"${ this.formatGamepadValue(this.controls.up) }\" placeholder=\"Press a button on your controller\" />\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</li>\n\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\t<div class=\"item-content item-input\">\n\t\t\t\t\t\t\t\t<div class=\"item-inner\">\n\t\t\t\t\t\t\t\t\t<div class=\"item-title item-label\">\n\t\t\t\t\t\t\t\t\t\tDown\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<div class=\"item-input-wrap\">\n\t\t\t\t\t\t\t\t\t\t<input class=\"gamepad-input\" maxlength=\"0\" type=\"text\" name=\"down\" id=\"down_input\" value=\"${ this.formatGamepadValue(this.controls.down) }\" placeholder=\"Press a button on your controller\" />\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</li>\n\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\t<div class=\"item-content item-input\">\n\t\t\t\t\t\t\t\t<div class=\"item-inner\">\n\t\t\t\t\t\t\t\t\t<div class=\"item-title item-label\">\n\t\t\t\t\t\t\t\t\t\tLeft\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<div class=\"item-input-wrap\">\n\t\t\t\t\t\t\t\t\t\t<input class=\"gamepad-input\" maxlength=\"0\" type=\"text\" name=\"left\" id=\"left_input\" value=\"${ this.formatGamepadValue(this.controls.left) }\" placeholder=\"Press a button on your controller\" />\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</li>\n\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\t<div class=\"item-content item-input\">\n\t\t\t\t\t\t\t\t<div class=\"item-inner\">\n\t\t\t\t\t\t\t\t\t<div class=\"item-title item-label\">\n\t\t\t\t\t\t\t\t\t\tRight\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<div class=\"item-input-wrap\">\n\t\t\t\t\t\t\t\t\t\t<input class=\"gamepad-input\" maxlength=\"0\" type=\"text\" name=\"right\" id=\"right_input\" value=\"${ this.formatGamepadValue(this.controls.right) }\" placeholder=\"Press a button on your controller\" />\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</li>\n\t\t\t\t\t</ul>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"block-title block-title-medium\">\n\t\t\t\t\tStart/Select\n\t\t\t\t</div>\n\t\t\t\t<div class=\"list no-hairlines-md\">\n\t\t\t\t\t<ul>\n\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\t<div class=\"item-content item-input\">\n\t\t\t\t\t\t\t\t<div class=\"item-inner\">\n\t\t\t\t\t\t\t\t\t<div class=\"item-title item-label\">\n\t\t\t\t\t\t\t\t\t\tStart\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<div class=\"item-input-wrap\">\n\t\t\t\t\t\t\t\t\t\t<input class=\"gamepad-input\" maxlength=\"0\" type=\"text\" name=\"start\" id=\"start_input\" value=\"${ this.formatGamepadValue(this.controls.start) }\" placeholder=\"Press a button on your controller\" />\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</li>\n\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\t<div class=\"item-content item-input\">\n\t\t\t\t\t\t\t\t<div class=\"item-inner\">\n\t\t\t\t\t\t\t\t\t<div class=\"item-title item-label\">\n\t\t\t\t\t\t\t\t\t\tSelect\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<div class=\"item-input-wrap\">\n\t\t\t\t\t\t\t\t\t\t<input class=\"gamepad-input\" maxlength=\"0\" type=\"text\" name=\"select\" id=\"select_input\" value=\"${ this.formatGamepadValue(this.controls.select) }\" placeholder=\"Press a button on your controller\" />\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</li>\n\t\t\t\t\t</ul>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"block-title block-title-medium\">\n\t\t\t\t\tFace Buttons\n\t\t\t\t</div>\n\t\t\t\t<div class=\"list no-hairlines-md\">\n\t\t\t\t\t<ul>\n\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\t<div class=\"item-content item-input\">\n\t\t\t\t\t\t\t\t<div class=\"item-inner\">\n\t\t\t\t\t\t\t\t\t<div class=\"item-title item-label\">\n\t\t\t\t\t\t\t\t\t\tA\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<div class=\"item-input-wrap\">\n\t\t\t\t\t\t\t\t\t\t<input class=\"gamepad-input\" maxlength=\"0\" type=\"text\" name=\"a\" id=\"a_input\" value=\"${ this.formatGamepadValue(this.controls.a) }\" placeholder=\"Press a button on your controller\" />\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</li>\n\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\t<div class=\"item-content item-input\">\n\t\t\t\t\t\t\t\t<div class=\"item-inner\">\n\t\t\t\t\t\t\t\t\t<div class=\"item-title item-label\">\n\t\t\t\t\t\t\t\t\t\tB\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<div class=\"item-input-wrap\">\n\t\t\t\t\t\t\t\t\t\t<input class=\"gamepad-input\" maxlength=\"0\" type=\"text\" name=\"b\" id=\"b_input\" value=\"${ this.formatGamepadValue(this.controls.b) }\" placeholder=\"Press a button on your controller\" />\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</li>\n\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\t<div class=\"item-content item-input\">\n\t\t\t\t\t\t\t\t<div class=\"item-inner\">\n\t\t\t\t\t\t\t\t\t<div class=\"item-title item-label\">\n\t\t\t\t\t\t\t\t\t\tX\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<div class=\"item-input-wrap\">\n\t\t\t\t\t\t\t\t\t\t<input class=\"gamepad-input\" maxlength=\"0\" type=\"text\" name=\"x\" id=\"x_input\" value=\"${ this.formatGamepadValue(this.controls.x) }\" placeholder=\"Press a button on your controller\" />\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</li>\n\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\t<div class=\"item-content item-input\">\n\t\t\t\t\t\t\t\t<div class=\"item-inner\">\n\t\t\t\t\t\t\t\t\t<div class=\"item-title item-label\">\n\t\t\t\t\t\t\t\t\t\tY\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<div class=\"item-input-wrap\">\n\t\t\t\t\t\t\t\t\t\t<input class=\"gamepad-input\" maxlength=\"0\" type=\"text\" name=\"y\" id=\"y_input\" value=\"${ this.formatGamepadValue(this.controls.y) }\"placeholder=\"Press a button on your controller\" />\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</li>\n\t\t\t\t\t</ul>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"block-title block-title-medium\">\n\t\t\t\t\tShoulder Buttons\n\t\t\t\t</div>\n\t\t\t\t<div class=\"list no-hairlines-md\">\n\t\t\t\t\t<ul>\n\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\t<div class=\"item-content item-input\">\n\t\t\t\t\t\t\t\t<div class=\"item-inner\">\n\t\t\t\t\t\t\t\t\t<div class=\"item-title item-label\">\n\t\t\t\t\t\t\t\t\t\tL\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<div class=\"item-input-wrap\">\n\t\t\t\t\t\t\t\t\t\t<input class=\"gamepad-input\" maxlength=\"0\" type=\"text\" name=\"l\" id=\"l_input\" value=\"${ this.formatGamepadValue(this.controls.l) }\" placeholder=\"Press a button on your controller\" />\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</li>\n\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\t<div class=\"item-content item-input\">\n\t\t\t\t\t\t\t\t<div class=\"item-inner\">\n\t\t\t\t\t\t\t\t\t<div class=\"item-title item-label\">\n\t\t\t\t\t\t\t\t\t\tR\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<div class=\"item-input-wrap\">\n\t\t\t\t\t\t\t\t\t\t<input class=\"gamepad-input\" maxlength=\"0\" type=\"text\" name=\"r\" id=\"r_input\" value=\"${ this.formatGamepadValue(this.controls.r) }\" placeholder=\"Press a button on your controller\" />\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</li>\n\t\t\t\t\t</ul>\n\t\t\t\t</div>\n\t\t\t</form>\n\t\t</div>\n\t</div>\n`;\n  },\n  styleScoped: false\n};"],"sourceRoot":""}