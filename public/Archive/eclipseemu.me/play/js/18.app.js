(window.webpackJsonp=window.webpackJsonp||[]).push([[18],{12:function(e,t,a){(function(a){var o,n;void 0===(n="function"==typeof(o=function(){"use strict";function t(e,t,a){var o=new XMLHttpRequest;o.open("GET",e),o.responseType="blob",o.onload=function(){s(o.response,t,a)},o.onerror=function(){console.error("could not download file")},o.send()}function o(e){var t=new XMLHttpRequest;t.open("HEAD",e,!1);try{t.send()}catch(e){}return 200<=t.status&&t.status<=299}function n(e){try{e.dispatchEvent(new MouseEvent("click"))}catch(a){var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(t)}}var i="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof a&&a.global===a?a:void 0,s=i.saveAs||("object"!=typeof window||window!==i?function(){}:"download"in HTMLAnchorElement.prototype?function(e,a,s){var l=i.URL||i.webkitURL,c=document.createElement("a");a=a||e.name||"download",c.download=a,c.rel="noopener","string"==typeof e?(c.href=e,c.origin===location.origin?n(c):o(c.href)?t(e,a,s):n(c,c.target="_blank")):(c.href=l.createObjectURL(e),setTimeout((function(){l.revokeObjectURL(c.href)}),4e4),setTimeout((function(){n(c)}),0))}:"msSaveOrOpenBlob"in navigator?function(e,a,i){if(a=a||e.name||"download","string"!=typeof e)navigator.msSaveOrOpenBlob(function(e,t){return void 0===t?t={autoBom:!1}:"object"!=typeof t&&(console.warn("Deprecated: Expected third argument to be a object"),t={autoBom:!t}),t.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type)?new Blob(["\ufeff",e],{type:e.type}):e}(e,i),a);else if(o(e))t(e,a,i);else{var s=document.createElement("a");s.href=e,s.target="_blank",setTimeout((function(){n(s)}))}}:function(e,a,o,n){if((n=n||open("","_blank"))&&(n.document.title=n.document.body.innerText="downloading..."),"string"==typeof e)return t(e,a,o);var s="application/octet-stream"===e.type,l=/constructor/i.test(i.HTMLElement)||i.safari,c=/CriOS\/[\d]+/.test(navigator.userAgent);if((c||s&&l)&&"object"==typeof FileReader){var r=new FileReader;r.onloadend=function(){var e=r.result;e=c?e:e.replace(/^data:[^;]*;/,"data:attachment/file;"),n?n.location.href=e:location=e,n=null},r.readAsDataURL(e)}else{var d=i.URL||i.webkitURL,p=d.createObjectURL(e);n?n.location=p:location.href=p,n=null,setTimeout((function(){d.revokeObjectURL(p)}),4e4)}});i.saveAs=s.saveAs=s,e.exports=s})?o.apply(t,[]):o)||(e.exports=n)}).call(this,a(5))},26:function(e,t,a){"use strict";a.r(t);var o=a(12),n=a(2);t.default={data:function(){return this.$route.context},methods:{downloadSave:function(){try{var e=JSON.parse(localStorage.getItem("SAVE_".concat(this.game.id))),t=Object(n.b)(JSON.parse(localStorage.getItem("SAVE_".concat(e)))),a=new Uint8Array(t),i=new Blob([a],{type:"application/octet-stream"});Object(o.saveAs)(i,"".concat(this.game.name," ").concat((new Date).getTime(),".sav"))}catch(e){this.$app.dialog.alert("There is no save data for this game.")}},uploadSave:function(){document.getElementById("saveUpload").click()},fileUploaded:function(e){var t=this,a=this;this.$app.dialog.confirm("Are you sure you want to load this save?",(function(){console.log(e);var o=e.target.files[0],n=o.name.substring(o.name.lastIndexOf(".")+1).toLowerCase(),i=0===o.name.indexOf("gamesave-")&&o.name.indexOf("-gamesave")===o.name.length-9;if(console.log(n),n==="eclipsesave_".concat(t.game.system.toLowerCase()))(s=new FileReader).readAsDataURL(o),s.onload=function(){var e=s.result,o=JSON.parse(atob(e.replace("data:;base64,","").replace("data:text/plain;charset=x-user-defined;base64,","").replace("data:application/octet-stream;base64,","").replace("ï»¿","")));localStorage.setItem("SAVE_".concat(JSON.parse(localStorage.getItem("SAVE_".concat(a.game.id)))),JSON.stringify(o)),t.$app.toast.create({text:'Loaded legacy Eclipse save for "'.concat(a.game.name,'".'),closeTimeout:2e3}).open()},s.onerror=function(e){t.$app.toast.create({text:"Could not load legacy Eclipse save file.",closeTimeout:2e3}).open(),console.log("Error: ",e)};else if("sav"===n||i){var s;(s=new FileReader).readAsDataURL(o),s.onload=function(){var e=s.result.replace("data:;base64,","").replace("data:text/plain;charset=x-user-defined;base64,","").replace("data:application/octet-stream;base64,","").replace("ï»¿","");localStorage.setItem("SAVE_".concat(JSON.parse(localStorage.getItem("SAVE_".concat(a.game.id)))),JSON.stringify(e)),a.$app.toast.create({text:i?'Loaded Delta save for "'.concat(a.game.name,'".'):'Loaded battery save for "'.concat(a.game.name,'".'),closeTimeout:2e3}).open()},s.onerror=function(e){a.$app.toast.create({text:i?"Could not load Delta save file.":"Could not load battery save file.",closeTimeout:2e3}).open(),console.log("Error: ",e)}}else t.$app.dialog.alert('Invalid file type. Please upload an "eclipsesave_'.concat(t.game.system.toLowerCase(),'" or .sav file.'))}))},resetSave:function(){var e=this;this.$app.dialog.confirm("Are you sure you want to reset your save? All progress will be lost.",(function(){e.$app.methods.storage.remove("SAVE_".concat(JSON.parse(localStorage.getItem("SAVE_".concat(e.game.id)))))}))}},id:"4e01dc3f1d",render:function(){return'\n  <div class="popup">\n    <div class="view">\n      <div class="page">\n        <div class="navbar">\n          <div class="navbar-inner">\n            <div class="left">\n              <a class="link popup-close">\n                <i class="icon f7-icons ios-only">close</i>\n                <i class="icon material-icons md-only">close</i>\n              </a>\n            </div>\n            <div class="title">Save</div>\n          </div>\n        </div>\n        <div class="page-content">\n          <div class="block" style="text-align: center;">\n            <img src="'.concat(-1<this.game.boxart.indexOf(" ")?encodeURI(this.game.boxart):this.game.boxart,'" style="border-radius: 5px; max-height: 256px; max-width: 256px">\n            <h1>').concat(this.game.name,"</h1>\n            <p>").concat(this.$app.methods.game.expandSystem(this.game.system),'</p>\n            <p>Below, you can easily download, upload, or remove your save data for this game.</p>\n          </div>\n          <div class="list">\n            <ul>\n              <li>\n                <a class="item-link list-button" @click="downloadSave">Download</a>\n              </li>\n              <li>\n                <a class="item-link list-button" @click="uploadSave">Upload</a>\n              </li>\n            </ul>\n          </div>\n          <input id="saveUpload" type="file" style="display:none;" @change="fileUploaded">\n          <div class="list">\n            <ul>\n              <li>\n                <a class="item-link list-button text-color-red" @click="resetSave">Reset</a>\n              </li>\n            </ul>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n')},styleScoped:!1}}}]);
//# sourceMappingURL=18.app.js.map